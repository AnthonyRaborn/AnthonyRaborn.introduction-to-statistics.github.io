<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.548">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Anthony Raborn, Psychometrician">
<meta name="dcterms.date" content="2024-01-25">

<title>Simple Linear Regression Lecture Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#building-upon" id="toc-building-upon" class="nav-link" data-scroll-target="#building-upon">Building upon…</a></li>
  <li><a href="#lesson-objectives" id="toc-lesson-objectives" class="nav-link" data-scroll-target="#lesson-objectives">Lesson Objectives</a></li>
  <li><a href="#what-is-simple-linear-regression" id="toc-what-is-simple-linear-regression" class="nav-link" data-scroll-target="#what-is-simple-linear-regression">What is Simple Linear Regression?</a>
  <ul class="collapse">
  <li><a href="#questions-it-can-answer" id="toc-questions-it-can-answer" class="nav-link" data-scroll-target="#questions-it-can-answer">Questions it <em>can</em> answer</a></li>
  <li><a href="#questions-it-cannot-answer" id="toc-questions-it-cannot-answer" class="nav-link" data-scroll-target="#questions-it-cannot-answer">Questions it <em>cannot</em> answer</a></li>
  </ul></li>
  <li><a href="#regression-line-of-best-fit" id="toc-regression-line-of-best-fit" class="nav-link" data-scroll-target="#regression-line-of-best-fit">Regression “Line of Best Fit”</a>
  <ul class="collapse">
  <li><a href="#example-data" id="toc-example-data" class="nav-link" data-scroll-target="#example-data">Example data</a></li>
  <li><a href="#line-of-best-fit" id="toc-line-of-best-fit" class="nav-link" data-scroll-target="#line-of-best-fit">Line of Best Fit</a></li>
  <li><a href="#bad-fit" id="toc-bad-fit" class="nav-link" data-scroll-target="#bad-fit">Bad fit:</a></li>
  <li><a href="#best-fit" id="toc-best-fit" class="nav-link" data-scroll-target="#best-fit">Best fit:</a></li>
  <li><a href="#both-lines" id="toc-both-lines" class="nav-link" data-scroll-target="#both-lines">Both lines</a></li>
  </ul></li>
  <li><a href="#deriving-the-least-squares-estimator-as-the-line-of-best-fit" id="toc-deriving-the-least-squares-estimator-as-the-line-of-best-fit" class="nav-link" data-scroll-target="#deriving-the-least-squares-estimator-as-the-line-of-best-fit">Deriving the Least Squares Estimator as the Line of Best Fit</a>
  <ul class="collapse">
  <li><a href="#derivatives" id="toc-derivatives" class="nav-link" data-scroll-target="#derivatives">Derivatives:</a></li>
  <li><a href="#algebraic-estimates-of-least-squares" id="toc-algebraic-estimates-of-least-squares" class="nav-link" data-scroll-target="#algebraic-estimates-of-least-squares">Algebraic Estimates of Least Squares</a></li>
  </ul></li>
  <li><a href="#review-of-regression-coefficients" id="toc-review-of-regression-coefficients" class="nav-link" data-scroll-target="#review-of-regression-coefficients">Review of Regression Coefficients</a>
  <ul class="collapse">
  <li><a href="#relationship-between-beta_1-and-correlation" id="toc-relationship-between-beta_1-and-correlation" class="nav-link" data-scroll-target="#relationship-between-beta_1-and-correlation">Relationship between <span class="math inline">\(\beta_1\)</span> and Correlation</a></li>
  </ul></li>
  <li><a href="#perform-simple-regression-in-r" id="toc-perform-simple-regression-in-r" class="nav-link" data-scroll-target="#perform-simple-regression-in-r">Perform Simple Regression in R</a>
  <ul class="collapse">
  <li><a href="#algebraically" id="toc-algebraically" class="nav-link" data-scroll-target="#algebraically">Algebraically</a></li>
  <li><a href="#with-lm" id="toc-with-lm" class="nav-link" data-scroll-target="#with-lm">With <code>lm</code></a></li>
  </ul></li>
  <li><a href="#practice" id="toc-practice" class="nav-link" data-scroll-target="#practice">Practice</a></li>
  <li><a href="#end" id="toc-end" class="nav-link" data-scroll-target="#end">End</a></li>
  <li><a href="#outline-for-subsequent-lectures-in-simple-linear-regression" id="toc-outline-for-subsequent-lectures-in-simple-linear-regression" class="nav-link" data-scroll-target="#outline-for-subsequent-lectures-in-simple-linear-regression">Outline for Subsequent Lectures in Simple Linear Regression</a>
  <ul class="collapse">
  <li><a href="#assumptions-of-simple-regression" id="toc-assumptions-of-simple-regression" class="nav-link" data-scroll-target="#assumptions-of-simple-regression">Assumptions of Simple Regression</a></li>
  </ul></li>
  <li><a href="#head" id="toc-head" class="nav-link" data-scroll-target="#head">&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</a>
  <ul class="collapse">
  <li><a href="#r-diagnostic-plots" id="toc-r-diagnostic-plots" class="nav-link" data-scroll-target="#r-diagnostic-plots">R Diagnostic Plots</a></li>
  <li><a href="#future-regression-topics" id="toc-future-regression-topics" class="nav-link" data-scroll-target="#future-regression-topics">Future Regression Topics</a></li>
  </ul></li>
  <li><a href="#head-1" id="toc-head-1" class="nav-link" data-scroll-target="#head-1">&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Simple Linear Regression</h1>
<p class="subtitle lead">University of Florida</p>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2024-01-25</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Below are the lecture notes, based on the slides, for the first Simple Linear Regression lecture. Following these notes are draft lecture notes for subsequent lectures.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># https://ufl.zoom.us/j/7362215223</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<div class="columns">
<div class="column" style="width:40%;">
<section id="myself" class="level3">
<h3 class="anchored" data-anchor-id="myself">Myself</h3>
<ul>
<li>UF Graduate, 2019</li>
<li>2.5 years K-12, 2.5 years C&amp;L</li>
<li>Reproducible and automated data analysis</li>
</ul>
</section>
</div><div class="column" style="width:60%;">
<section id="approach-to-instruction" class="level3">
<h3 class="anchored" data-anchor-id="approach-to-instruction">Approach to Instruction</h3>
<ul>
<li>Reproducible slides and lectures</li>
<li>Embedded practice within lectures</li>
<li>Provide multiple solutions to problems (where possible)
<ul>
<li>focusing on reproducibility as much as reasonable!</li>
</ul></li>
</ul>
</section>
</div>
</div>
<div class="notes">
<p>First, a little bit about myself and my approach to teaching.</p>
<p>I graduated from the University of Florida about 5 years ago, with a Ph.D.&nbsp;in Research and Evaluation Methodology and a minor in Statistics. Dr.&nbsp;Manley and Dr.&nbsp;Leite were my advisors.</p>
<p>I worked about two and a half years with Pasco County Schools as a Supervisor, Accountability, Research, and Measurement before my current two and a half years with the National Association of Boards of Pharmacy. NABP is in the certification and licensure industry, and I work on our licensing exams and related data for prospective pharmacists.</p>
<p>My professional focus is on reproducible and automated data analytic processes. If I’m asked to do the same task twice, I begin thinking about how to make that process automatic through programming, which also allows me to have a record to refer to for future requests. Any research I do follows a similar process, and I have a few R packages that came from work with colleagues on improving the flexibility of scripts.</p>
<p>My approach to teaching mirrors from this focus. I aim to provide lectures that are easily editable and reproducible. This means that students would have direct access to my lecture slides and notes, and that I can make, track, and share changes to these notes in real-time.</p>
<p>I do this by embedding my instruction within the software I use for analysis. For example, this lecture is created within R using Quarto and will be available for everyone to access on my GitHub account.</p>
<p>While I encourage students to follow a similar mindset with statistics and data analysis, I support and expect to provide support for multiple different approaches, including different software. My aim is to help everyone get to the point of creating reproducible work, if possible, and support students who are not as technically-oriented produce good work regardless of its reproducibility.</p>
<p>For today, though, I will be working in R exclusively.</p>
</div>
</section>
<section id="building-upon" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="building-upon">Building upon…</h2>
<ul>
<li>Mathematical notation
<ul>
<li>bar notation, i notation, sum notation, hat notation</li>
</ul></li>
<li>Normal distribution
<ul>
<li>symmetric, bell-shaped</li>
</ul></li>
<li>statistical error
<ul>
<li>random differences</li>
</ul></li>
<li>correlation
<ul>
<li>strength of linear relationship</li>
</ul></li>
<li>statistical parameter
<ul>
<li>general understanding</li>
</ul></li>
</ul>
<div class="notes">
<p>This lecture assumes that you are familiar with the following topics, as they will be touched upon but not fully explained.</p>
<ol type="1">
<li>Mathematical notation—subscripted i, squares, square roots, sum notation, bar notation, hat notation</li>
<li>What the normal distribution is—most importantly, that it is a symmetrical and bell-shaped distribution, meaning that values drawn from this distribution are less likely to be observed the further they are (in either direction) from the mean.</li>
<li>What statistical error is—most importantly, that it means random differences between expected or estimated values and observed values, not systemic differences or differences due to things like biased measurements or mis-keyed data.</li>
<li>What correlation is—most importantly, that it measures the strength of the linear relationship between two variables.</li>
<li>What statistical parameters are–just a general understanding that they provide a mathematical way to describe a statistical model and that analyses try to estimate these values</li>
</ol>
</div>
</section>
<section id="lesson-objectives" class="level2">
<h2 class="anchored" data-anchor-id="lesson-objectives">Lesson Objectives</h2>
<ol type="1">
<li>Understand what simple linear regression is and when it should be used</li>
<li>Estimate and Interpret regression coefficients</li>
<li>Utilize R for fitting regression models</li>
</ol>
<p>Next time:</p>
<ol start="4" type="1">
<li>Summarize the four main assumptions of regression</li>
<li>Read diagnostic plots</li>
<li>Perform hypothesis testing on simple linear regression models</li>
</ol>
<div class="notes">
<p>At the end of this lesson, you should be able to:</p>
<ul>
<li>Understand what simple linear regression is, when it should be used (and by converse when it shouldn’t be used).</li>
<li>Estimate the model coefficients for regression algebraically as well as interpret these coefficients.</li>
<li>Utilize R for fitting regression models</li>
</ul>
<p>We won’t have enough time to cover these topics, but the next lecture would also add these objectives:</p>
<ul>
<li>Summarize the four main assumptions of regression.</li>
<li>Read and interpret some regression diagnostic plots, identifying obvious violations of the four assumptions</li>
<li>Perform hypothesis testing on the coefficients of a fit regression model</li>
</ul>
</div>
</section>
<section id="what-is-simple-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="what-is-simple-linear-regression">What is Simple Linear Regression?</h2>
<ul>
<li>Statistical (NOT deterministic) model
<ul>
<li>explores how variation in one variable is related to (explained by) variation in a second variable</li>
</ul></li>
<li>Draws a “line of best fit” between variables
<ul>
<li>Geometric <span class="math inline">\(y = mx + b\)</span> vs statistical <span class="math inline">\(y = \beta_0 + \beta_1 x\)</span></li>
</ul></li>
<li>Uses values of one predictor (explanatory, independent) variable <em>x</em> to estimate values of one outcome (response, dependent) variable <em>y</em></li>
<li>For today, <em>x</em> and <em>y</em> will be continuous
<ul>
<li>(though <em>x</em> can be categorical!)</li>
</ul></li>
</ul>
<div class="notes">
<p>Simple linear regression (generally referred to as “regression” hereout; other regression models would be directly specified) is a statistical model that explains how the variation in one variable is related to the variation in a second variable. Sometimes, the “related to” part is stated as “explained by”, which is fine but keep in mind that “explained by” does NOT mean “caused by”.</p>
<p>Statistical models are contrasted with deterministic models, which are perfect predictions of y given x. A good example of this is the relationship between Fahrenheit and Celsius: knowing one gives you an exact value for the other: <span class="math inline">\(F = 32 + 1.8*C\)</span></p>
<p>A regression draws a “line of best fit”—for a specific definition of “best”—between the two variables. This line is in the same form as the geometric line, <span class="math inline">\(y = mx + b\)</span>, but in statistical terms we usually refer to this regression line as <span class="math inline">\(y = \beta_0 + \beta_1*x\)</span>, with <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> referred to as regression parameters.</p>
<p>As you can see from the statistical form, the value of one variable—x—is used to predict the value of the second variable—y. The x variable is interchangeably referred to as predictor, explanatory, or independent, while the y variable is interchangeably referred to as the outcome, response, or dependent variable. The parameters provide the mathematical relationship between the two variables as a straight line.</p>
<p>For today, we will consider cases where both x and y are continuous variables. However, in a simple linear regression, x can also be categorical and the model will still work.</p>
</div>
<hr>
<section id="questions-it-can-answer" class="level3">
<h3 class="anchored" data-anchor-id="questions-it-can-answer">Questions it <em>can</em> answer</h3>
<ul>
<li>statistical, linear relationship between two variables</li>
<li>predictions of group averages
<ul>
<li>strength of differences between mathematical groups</li>
</ul></li>
<li>predictions of new, individual values
<ul>
<li>generally includes interpolation</li>
</ul></li>
</ul>
<div class="notes">
<p>We can use regression to investigate the statistical, linear relationship between two variables. It gives us the predicted value of group averages—that is, the difference in the average value of the outcome variable for some mathematical and possibly theoretical group based on the predictor variable. This can be observed predictor groups or—if we are careful and the variability of the predictor allows it—unobserved, interpolated predictor groups. Note that outliers or extreme values affect the quality of your interpolation, though we will not investigate that today.</p>
</div>
<hr>
</section>
<section id="questions-it-cannot-answer" class="level3">
<h3 class="anchored" data-anchor-id="questions-it-cannot-answer">Questions it <em>cannot</em> answer</h3>
<ul>
<li>nonlinear relationships
<ul>
<li>polynomial regression</li>
</ul></li>
<li>effects of multiple predictor variables
<ul>
<li>multiple regression</li>
</ul></li>
<li>effects of one variable to many variables
<ul>
<li>multivariate regression</li>
</ul></li>
<li>causal relationship (by itself)
<ul>
<li>additional requirements</li>
</ul></li>
<li>extrapolation</li>
</ul>
<div class="notes">
<p>A simple linear regression can’t answer questions about nonlinear relationships between variables; we can use polynomial regression in some cases, or transformations of the variables in other cases, but using original units of x and y the relationship must be linear for simple linear regression to be appropriate.</p>
<p>We also can’t answer questions with multiple predictor variables (yet; multiple regression can), or with multiple outcome variables (multivariate regression can).</p>
<p>Regression, by itself, CANNOT answer causal relationships (i.e., does a change in x CAUSE a specific change in average y). There are other conditions that must be satisfied before we can make causal interpretations. For now, we assume that changes are associative only.</p>
<p>Extrapolating outside the range of your x values is also generally inappropriate. We can use regression to give us an idea of how average y values change for x values outside of the range of x values in the sample, but the further we get from the observed range the more hazardous and inappropriate the extrapolation gets. Extrapolate with caution!</p>
</div>
</section>
</section>
<section id="regression-line-of-best-fit" class="level2">
<h2 class="anchored" data-anchor-id="regression-line-of-best-fit">Regression “Line of Best Fit”</h2>
<section id="example-data" class="level3">
<h3 class="anchored" data-anchor-id="example-data">Example data</h3>
<p>We have a record of a hypothetical sample of college-aged (18-22) males, with data for their heights (in inches) and weights (in pounds).</p>
<p>The data-generating process for our sample is defined below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">70</span>, <span class="dv">4</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="sc">+</span> <span class="fl">1.75</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>height_data <span class="ot">&lt;-</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">height =</span> x</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>         , <span class="at">weight =</span> y</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="notes">
<p>We’re going to return to this idea of a “line of best fit”, but first let’s generate some data that we know follows a simple regression model. This data will represent a sample of 100 college-aged (18 yrs old – 22 yrs old) males, with data collected on their height (in inches) and weight (in pounds).</p>
<p>The R code for generating this data can be seen here.</p>
<p>Next is a scatterplot of the resulting data. What can we tell about the association between height and weight from this plot alone?</p>
<p>(positive correlation; positive/linear association/relationship; as height increases weight increases)</p>
<p>Let’s consider how we can draw a line that tells us the most likely weight for someone represented by our sample, given their height.</p>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>height_data <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">'Height (inches)'</span>) <span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">'Weight (pounds)'</span>) <span class="sc">+</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01-simple-linear-regression_files/figure-html/scatterplot-height-data-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Basic scatterplot</figcaption>
</figure>
</div>
</div>
<p>Male College Students Height (in inches; x-axis) and Weight (in pounds; y-axis)</p>
</div>
<div class="notes">
<p>In regression, the line of best fit is estimated with a process known as “least squares estimation”. We take it as true, for now, that this is the best way to create a prediction line of best fit for a linear association between two variables.</p>
<p>This process finds an intercept and slope that minimizes squared distance between line and observations (this distance is also known as error) for ALL observations simultaneously. Our predictions based on this line are as mathematically close as possible to all the observations in our data. In a moment, we will look at an example to help us understand why SQUARED error is used over OBSERVED error.</p>
</div>
<hr>
</section>
<section id="line-of-best-fit" class="level3">
<h3 class="anchored" data-anchor-id="line-of-best-fit">Line of Best Fit</h3>
<p>Least Squares Estimator:</p>
<ul>
<li>Minimizes squared distance between line and observations (error) for ALL observations</li>
</ul>
<p><span class="math display">\[\text{L}_{min} = \text{argmin}(\Sigma_{i=1}^n (y_i - \hat{y_i})^2)\]</span></p>
<div class="notes">
<p>The equation here defines the problem mathematically. The important part to understand is that we are taking the difference between the observed values, <span class="math inline">\(y_i\)</span>, and the values predicted by the regression line, <span class="math inline">\(\hat{y_i}\)</span>, as our error. We then square the error and add the sums. We are looking for a line that produces the values <span class="math inline">\(\hat{y_i}\)</span> that results in the smallest possible sum of squared errors in our sample.</p>
</div>
<hr>
</section>
<section id="bad-fit" class="level3">
<h3 class="anchored" data-anchor-id="bad-fit">Bad fit:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>height_data <span class="ot">&lt;-</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  height_data <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># bad_prediction = 30 + 2*height </span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">bad_prediction =</span> <span class="sc">-</span>.<span class="dv">9276</span> <span class="sc">+</span> <span class="fl">2.471429</span><span class="sc">*</span>height</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    , <span class="at">bad_error =</span> weight <span class="sc">-</span> bad_prediction</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    , <span class="at">prediction =</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height) <span class="sc">|&gt;</span> <span class="fu">predict</span>()</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    , <span class="at">error =</span> weight <span class="sc">-</span> prediction</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    , <span class="at">sum_error_bad =</span> <span class="fu">sum</span>(bad_error)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    , <span class="at">sum_error_best =</span> <span class="fu">sum</span>(error)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    , <span class="at">SSE_bad =</span> <span class="fu">sum</span>(bad_error<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    , <span class="at">SSE_best =</span> <span class="fu">sum</span>(error<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>height_data <span class="sc">%&gt;%</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="sc">-</span>.<span class="dv">9276</span>, <span class="at">slope =</span> <span class="fl">2.471429</span>, <span class="at">color =</span> <span class="st">'red'</span>) <span class="sc">+</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> weight, <span class="at">ymin =</span> bad_prediction)) <span class="sc">+</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Weight (pounds)"</span>) <span class="sc">+</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Height (inches)"</span>) <span class="sc">+</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">60</span>, <span class="dv">80</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">150</span>, <span class="dv">200</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01-simple-linear-regression_files/figure-html/sample-bad-fit-height-data-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>With a poorly-fitting line</figcaption>
</figure>
</div>
</div>
<p>Male College Students Height (x) and Weight (y)</p>
</div>
<div class="notes">
<p>This next graph shows what I am calling a “line of bad fit”. The red line looks like it provides reasonable estimates of weight for height values near the center of the distribution, but for both shorter and taller individuals it produces estimates that are noticeably further way from the prediction line. The black lines between the points and the red line are the errors. We could manually manipulate these errors (and I will show you how to later), but for now I will record these errors and use them later.</p>
</div>
<hr>
</section>
<section id="best-fit" class="level3">
<h3 class="anchored" data-anchor-id="best-fit">Best fit:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>height_data <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">fullrange=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> weight, <span class="at">ymin =</span> prediction)) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Weight (pounds)"</span>) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Height (inches)"</span>) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">60</span>, <span class="dv">80</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">150</span>, <span class="dv">200</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01-simple-linear-regression_files/figure-html/sample-good-fit-height-data-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>With a mathematically optimal line of best fit</figcaption>
</figure>
</div>
</div>
<p>Male College Students Height (x) and Weight (y)</p>
</div>
<div class="notes">
<p>It may be hard to compare right now, but this blue line is the line of best fit using least squares estimation. The errors should be noticeably smaller at the upper and lower values of height. Again, the black lines between the points and the blue line are the errors. Let’s see how these two lines compare to one another.</p>
</div>
<hr>
</section>
<section id="both-lines" class="level3">
<h3 class="anchored" data-anchor-id="both-lines">Both lines</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>sum_error_text <span class="ot">&lt;-</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">S(e) for the red line: "</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    , height_data<span class="sc">$</span>sum_error_bad[<span class="dv">1</span>] <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">1</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    , <span class="st">"</span><span class="sc">\n</span><span class="st">S(e) for the blue line: "</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    , height_data<span class="sc">$</span>sum_error_best[<span class="dv">1</span>] <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">1</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    , <span class="st">"</span><span class="sc">\n</span><span class="st">SS(e) for the red line: "</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    , height_data<span class="sc">$</span>SSE_bad[<span class="dv">1</span>] <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">1</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    , <span class="st">"</span><span class="sc">\n</span><span class="st">SS(e) for the blue line: "</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    , height_data<span class="sc">$</span>SSE_best[<span class="dv">1</span>] <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">1</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>height_data <span class="sc">%&gt;%</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="sc">-</span>.<span class="dv">9276</span>, <span class="at">slope =</span> <span class="fl">2.471429</span>, <span class="at">color =</span> <span class="st">'red'</span>) <span class="sc">+</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="dv">75</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    , <span class="at">y =</span> <span class="dv">160</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    , <span class="at">label =</span> sum_error_text) <span class="sc">+</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Weight (pounds)"</span>) <span class="sc">+</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Height (inches)"</span>) <span class="sc">+</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">60</span>, <span class="dv">80</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">150</span>, <span class="dv">200</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01-simple-linear-regression_files/figure-html/sample-both-fits-height-data-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>With Best Fit in Blue and “Bad” Fit in Red</figcaption>
</figure>
</div>
</div>
<p>Male College Students Height (x) and Weight (y)</p>
</div>
<div class="notes">
<p>Again, the red line is the “bad fit” and the blue line is the “best fit”. These lines are the same as in the previous graphs. We also see four values imposed on the graph: S(e), the sum of errors (notice that these are regular, NOT squared, errors) for both lines, and SS(e), the sum of squared errors for both lines.</p>
<p>Notice that the sum of unsquared errors is zero for both lines, but the sum of squared errors is lower for the blue least squares estimate line. Does everyone see why SS(e) is better than S(e) for regression lines?</p>
<p>(unsquared errors allows positive and negative errors to cancel; multiple possible solutions with unsquared errors)</p>
<p>Is there another method of minimizing errors that you think could also work?</p>
<p>(e.g., absolute errors)</p>
</div>
</section>
</section>
<section id="deriving-the-least-squares-estimator-as-the-line-of-best-fit" class="level2">
<h2 class="anchored" data-anchor-id="deriving-the-least-squares-estimator-as-the-line-of-best-fit">Deriving the Least Squares Estimator as the Line of Best Fit</h2>
<div>
<ul>
<li>Population model:
<ul>
<li><span class="math inline">\(y = \beta_0 + \beta_1x\)</span></li>
<li><span class="math inline">\(y_i = \beta_0 + \beta_1 x_i + \epsilon_i\)</span></li>
</ul></li>
<li>Estimation: <span class="math inline">\(\hat{y}_i = \hat{\beta}_0 + \hat{\beta}_1 x_i + \epsilon_i\)</span></li>
<li>Minimize the squared errors, defined as: <span class="math inline">\(\text{L} = \Sigma_{i=1}^n \epsilon_i^2 = \Sigma_{i=1}^n (y_i - \hat{y_i})^2 = \Sigma_{i=1}^n(y_i - \hat{\beta_0} - \hat{\beta_1} x_i)^2\)</span></li>
</ul>
</div>
<div class="notes">
<p>(make sure discussion of squared errors happened)</p>
<p>Again, here is the statistical equation for a regression line for our observations, with the addition of the error terms and the subscript for individual observations.</p>
<p>Remember that to show that we are moving from the population model to an estimation, we add “hats” to the values that are estimated. Now, our observed x values are used to estimate <span class="math inline">\(\hat{y}\)</span> values with our estimated regression parameters, <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span> .</p>
<p>With a bit of algebra, we can redefine the Least Squares Estimator L as a function of the estimated regression line and the observed y values.</p>
<p>Any questions so far?</p>
<p>From here, we will see some of the derivation. If you are unfamiliar or out of practice with calculus, don’t worry; we will only consider the final equations moving forward. If you are interested in fully understanding the math (for example, if you want to take classes with the Statistics department), you should work on understanding these steps.</p>
</div>
<hr>
<section id="derivatives" class="level3">
<h3 class="anchored" data-anchor-id="derivatives">Derivatives:</h3>
<p><span class="math inline">\(\beta_0\)</span>: <span class="math display">\[\frac{\delta\text{L}}{\delta\beta_0} = -2\Sigma_{i=1}^n(y_i - \hat{\beta_0} - \hat{\beta_1} x_i) = 0\]</span> <span class="math display">\[n\hat{\beta_0} + \hat{\beta_1}\Sigma_{i=1}^n x_i = \Sigma_{i=1}^n y_i\]</span></p>
<p><span class="math inline">\(\beta_1\)</span>: <span class="math display">\[\frac{\delta\text{L}}{\delta\beta_1} = -2\Sigma_{i=1}^n(y_i - \hat{\beta_0} - \hat{\beta_1} x_i)x_i = 0\]</span> <span class="math display">\[\hat{\beta_0}\Sigma_{i=1}^n x_i + \hat{\beta_1}\Sigma_{i=1}^n x^2_i = \Sigma_{i=1}^n y_i x_i\]</span></p>
<div class="notes">
<p>This slide shows the results of taking the partial derivatives of the sum of squared errors, with respect to <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> respectively and setting the result to 0 (as we are looking for the minimum of the sum of squares). With some extra algebra, we get the following algebraic solution to the least squares estimator for simple linear regression.</p>
</div>
<hr>
</section>
<section id="algebraic-estimates-of-least-squares" class="level3">
<h3 class="anchored" data-anchor-id="algebraic-estimates-of-least-squares">Algebraic Estimates of Least Squares</h3>
<p><span class="math display">\[\hat{\beta_0} = \bar{y} - \hat{\beta_1} \bar{x}\]</span></p>
<p><span class="math display">\[\hat{\beta_1} = \frac{\Sigma_{i=1}^n(x_i-\bar{x})(y_i-\bar{y})}{\Sigma_{i=1}^n(x_i-\bar{x})^2}\]</span></p>
<div class="notes">
<p>Using these equations, we now have a way to estimate the slope and intercept of a regression equation for any data set with two continuous variables (and other situations we aren’t considering at the moment).</p>
<p>Notice that the intercept, <span class="math inline">\(\hat{\beta_0}\)</span>, depends on the slope, <span class="math inline">\(\hat{\beta_1}\)</span>, so if we are using these equations we need to solve for <span class="math inline">\(\hat{\beta_1}\)</span> first, then plug that estimate into <span class="math inline">\(\hat{\beta_0}\)</span></p>
<p>We will practice using these equations in a little bit.</p>
</div>
</section>
</section>
<section id="review-of-regression-coefficients" class="level2">
<h2 class="anchored" data-anchor-id="review-of-regression-coefficients">Review of Regression Coefficients</h2>
<div class="incremental">
<ul class="incremental">
<li><span class="math inline">\(\beta_0\)</span>: intercept
<ul class="incremental">
<li>Estimated <span class="math inline">\({\bar{y}}\)</span> when <span class="math inline">\(x = 0\)</span></li>
</ul></li>
</ul>
</div>
<div class="incremental">
<ul class="incremental">
<li><span class="math inline">\(\beta_1\)</span>: regression slope
<ul class="incremental">
<li>a one-point change in <span class="math inline">\(x\)</span> results in a <span class="math inline">\(\beta_1\)</span>-point change in the average of <span class="math inline">\(y\)</span></li>
<li>note: results does NOT mean causes!</li>
<li>a units-adjusted transformation of (Pearson) correlation</li>
</ul></li>
</ul>
</div>
<div class="notes">
<p>(Knowledge Check)</p>
<p>With the formulas to algebraically estimate the regression coefficients completed, let’s review what the parameters are and what they mean.</p>
<p><span class="math inline">\(\beta_0\)</span> is the intercept. It is interpreted as the expected or mean value of the outcome variable y when the predictor variable x equals zero.</p>
<p><span class="math inline">\(\beta_1\)</span> is the regression coefficient or regression slope. It is interpreted as the change in expected or mean y values resulting from a one-unit change in x values (as in, increasing x by 1 in whatever units it is measured in). Note that “results from” doesn’t mean “caused by” as we are not making causal relationships right now!</p>
<p>An interesting mathematical fact: the regression coefficient in a simple linear regression is a units-adjust transformation of the Pearson correlation; that is, for a given data set, <span class="math inline">\(\beta_1\)</span> and the correlation are directly related!</p>
</div>
<hr>
<section id="relationship-between-beta_1-and-correlation" class="level3">
<h3 class="anchored" data-anchor-id="relationship-between-beta_1-and-correlation">Relationship between <span class="math inline">\(\beta_1\)</span> and Correlation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>height_data <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> weight)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">'Height (inches)'</span>) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">'Weight (pounds)'</span>) <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01-simple-linear-regression_files/figure-html/showing-height-data-again-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Basic scatterplot</figcaption>
</figure>
</div>
</div>
<p>Male College Students Height (in inches; x-axis) and Weight (in pounds; y-axis)</p>
</div>
<div class="notes">
<p>Let’s briefly show how these are related.</p>
<p>First, take a look at the data we originally created. How would you characterize the correlation between height and weight? If you had to estimate the correlation coefficient, what value would you use?</p>
<p>(characterized: strong, positive; estimate: anything greater than .7 but not 1.0, definitely not negative)</p>
</div>
<hr>
<p>Pearson Correlation: <span class="math display">\[r_{(x,y)} = \frac{\Sigma^n_{i=1}(x_i-\bar{x})(y_i-\bar{y})}{\sqrt{\Sigma_{i=1}^n(x_i-\bar{x})^2\Sigma_{i=1}^n(y_i-\bar{y})^2}} = \frac{\text{cov}(x,y)}{\text{sd}(x)\text{sd}(y)}\]</span></p>
<p>Regression slope: <span class="math display">\[\hat{\beta_1} = \frac{\Sigma_{i=1}^n(x_i-\bar{x})(y_i-\bar{y})}{\Sigma_{i=1}^n(x_i-\bar{x})^2}=\frac{\text{cov}(x,y)}{\text{var}(x)}\]</span></p>
<div class="notes">
<p>Let’s revisit the equation for the Pearson correlation. Remember that correlation is unitless and can range from negative 1 to positive 1 but cannot go beyond this range.</p>
<p>Let’s compare that equation to the algebraic equation for beta_1. It should be evident that beta_1 is in units of y. Why?</p>
<p>(when x increased by 1 unit, y increases by beta_1 units, so beta_1 is in y units over x units. Mathematically, cov(x,y) is in x*y unites, and var(x) is in x^2 units, so we get y/x units. However, we generally interpret beta_1 in one-x-unit changes so the x units in the denominator are not important for interpretation)</p>
<p>Since both values use the covariance between x and y in the numerator, and the difference between the denominators is the variance of x and sd of both variables; some algebra makes them equivalent (but we’ll skip over the specifics).</p>
</div>
<hr>
<div class="columns">
<p>Relating the two:</p><p><span class="math inline">\(r = \hat{\beta_1}*\frac{\sqrt{\Sigma_{i=1}^n(x_i-\bar{x})^2}}{\sqrt{\Sigma_{i=1}^n(y_i-\bar{y})^2}}\)</span></p><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-overflow-wrap code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>pearson_correlation <span class="ot">&lt;-</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(height_data<span class="sc">$</span>height, height_data<span class="sc">$</span>weight) <span class="sc">|&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">3</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>regression_slope <span class="ot">&lt;-</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(weight <span class="sc">~</span> height, <span class="at">data =</span> height_data)<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">|&gt;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">3</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>numerator <span class="ot">&lt;-</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  (height_data<span class="sc">$</span>height <span class="sc">-</span> <span class="fu">mean</span>(height_data<span class="sc">$</span>height))<span class="sc">^</span><span class="dv">2</span> <span class="sc">|&gt;</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>() <span class="sc">|&gt;</span> <span class="fu">sqrt</span>() </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>denominator <span class="ot">&lt;-</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  (height_data<span class="sc">$</span>weight <span class="sc">-</span> <span class="fu">mean</span>(height_data<span class="sc">$</span>weight))<span class="sc">^</span><span class="dv">2</span> <span class="sc">|&gt;</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>() <span class="sc">|&gt;</span> <span class="fu">sqrt</span>()</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>units_adjustment <span class="ot">&lt;-</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  (numerator<span class="sc">/</span>denominator) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div><div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"r = "</span>, pearson_correlation, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"</span><span class="sc">\n</span><span class="st">beta_1 = "</span>, regression_slope, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"</span><span class="sc">\n</span><span class="st">units-adjustment = "</span>, units_adjustment,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"</span><span class="sc">\n</span><span class="st">r = beta_1 * units-adjustment?: "</span>, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  (regression_slope<span class="sc">*</span>units_adjustment) <span class="sc">|&gt;</span> </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="dv">3</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>r = 0.909
beta_1 = 1.749
units-adjustment = 0.52
r = beta_1 * units-adjustment?: 0.909</code></pre>
</div>
</div>
</div>
<div class="notes">
<p>On the left, we see the results from the algebraic manipulation I alluded to. By multiplying <span class="math inline">\(\beta_1\)</span> by the units-adjustment value, sqrt(SS(x)) / sqrt(SS(y)), the two values should be the same.</p>
<p>On the right is some R code that performs these calculations automatically. The <code>cor</code> function should look familiar. I took a shortcut and used the <code>lm</code> function instead of calculating <span class="math inline">\(\beta_1\)</span> myself, but we will see on the next slide that this result is functionally equivalent to the algebraic calculations on the same data. And, after calculating the units-adjustment value for the data and multiplying it with <span class="math inline">\(\beta_1\)</span>, we see that in fact the correlation and regression slope are related.</p>
</div>
</section>
</section>
<section id="perform-simple-regression-in-r" class="level2">
<h2 class="anchored" data-anchor-id="perform-simple-regression-in-r">Perform Simple Regression in R</h2>
<section id="algebraically" class="level3">
<h3 class="anchored" data-anchor-id="algebraically">Algebraically</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mean_x <span class="ot">&lt;-</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(height_data<span class="sc">$</span>height)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>mean_y <span class="ot">&lt;-</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(height_data<span class="sc">$</span>weight)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>SS_x <span class="ot">&lt;-</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>((height_data<span class="sc">$</span>height <span class="sc">-</span> mean_x)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>S_xy <span class="ot">&lt;-</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>((height_data<span class="sc">$</span>height <span class="sc">-</span> mean_x) <span class="sc">*</span> (height_data<span class="sc">$</span>weight <span class="sc">-</span> mean_y))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  S_xy <span class="sc">/</span> SS_x</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>beta_0 <span class="ot">&lt;-</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  mean_y <span class="sc">-</span> beta_1<span class="sc">*</span>mean_x</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Estimated Beta1: "</span>, beta_1 <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>))); <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Estimated Beta0: "</span>, beta_0 <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Estimated Beta1: 1.75"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Estimated Beta0: 49.94"</code></pre>
</div>
</div>
<div class="notes">
<p>Here is an of how to perform regression algebraically in R. This code snippet calculates the values we need for the least squares estimate of our regression coefficients using the data we simulated at the beginning of class. Note that the estimates for our coefficients are almost identical to the coefficients we used to simulate the data.</p>
</div>
<hr>
</section>
<section id="with-lm" class="level3">
<h3 class="anchored" data-anchor-id="with-lm">With <code>lm</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>lm_height_weight <span class="ot">&lt;-</span>   </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(weight <span class="sc">~</span> height, <span class="at">data =</span> height_data)  </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_height_weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ height, data = height_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.6305 -1.8413 -0.4185  1.6182  7.0385 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  49.9426     5.6982   8.765 5.78e-14 ***
height        1.7492     0.0808  21.650  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.888 on 98 degrees of freedom
Multiple R-squared:  0.8271,    Adjusted R-squared:  0.8253 
F-statistic: 468.7 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="notes">
<p>Here is another look at how we can get the same information using the <code>lm()</code> function built into R. By fitting the model, saving it to the <code>lm_height_weight</code> object, then using the <code>summary()</code> function on this object, we get a printout of the regression model, including a multitude of statistics. We will look further into these statistics in another lecture, so for now look for the Coefficients and their respective Estimate values. These values are basically equivalent to the values we found algebraically and to the values we used to simulate the data.</p>
</div>
</section>
</section>
<section id="practice" class="level2">
<h2 class="anchored" data-anchor-id="practice">Practice</h2>
<iframe width="100%" height="80%" src="https://4kve1c-anthony0raborn.shinyapps.io/simple-linear-regression/">
  </iframe>
<div class="notes">
<p>Now let’s practice what we’ve learned so far about regression.</p>
<p>This is a shiny app, built in R, that generates random data, plots the data, and lets us pick a line that we think fits the data. It also provides information about our data (e.g., means of the variables, the sum of squares for x and y individually, and the covariance between x and y). In case you don’t remember how to use these values to algebraically solve for the regression coefficients, there is a hint button you can press that will show them to you. It also shows our sum of squared errors so we know how well our guess (or math!) is at minimizing these errors.</p>
<p>Let’s generate some data and see how well we do!</p>
<p>(spend about 5 minutes)</p>
</div>
</section>
<section id="end" class="level2">
<h2 class="anchored" data-anchor-id="end">End</h2>
<p>Questions?</p>
<p>Lecture available at:</p>
<p>https://github.com/AnthonyRaborn/introduction-to-statistics/</p>
<div class="notes">
<p>Any questions?</p>
<p>(can I find a picture to add here?)</p>
</div>
</section>
<section id="outline-for-subsequent-lectures-in-simple-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="outline-for-subsequent-lectures-in-simple-linear-regression">Outline for Subsequent Lectures in Simple Linear Regression</h2>
<section id="assumptions-of-simple-regression" class="level3">
<h3 class="anchored" data-anchor-id="assumptions-of-simple-regression">Assumptions of Simple Regression</h3>
<div class="incremental">
<ol class="incremental" type="1">
<li>Linear function between x and y</li>
<li>Independence of errors</li>
<li>Normality of errors</li>
<li>Equality of error variances</li>
</ol>
</div>
<div class="incremental">
<ul class="incremental">
<li>Notice how 3 of 4 focus on errors, NOT the observed variables!</li>
<li>These are important for the quality of our model inferences.</li>
</ul>
</div>
</section>
</section>
<section id="head" class="level1">
<h1>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</h1>
<blockquote class="blockquote">
<blockquote class="blockquote">
<blockquote class="blockquote">
<blockquote class="blockquote">
<blockquote class="blockquote">
<blockquote class="blockquote">
<blockquote class="blockquote">
<p>946b5fb0f27eca67d94b53276b2925a05848ea49 ### Diagnosing Model Assumptions</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<section id="linear-relationship" class="level4">
<h4 class="anchored" data-anchor-id="linear-relationship">Linear relationship</h4>
<section id="good" class="level5">
<h5 class="anchored" data-anchor-id="good">Good:</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># label: good-example-linear-relationship</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(tidyverse)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>linear_data <span class="ot">&lt;-</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    , <span class="at">y =</span> <span class="dv">30</span> <span class="sc">+</span> <span class="dv">10</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">30</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>linear_data <span class="sc">%&gt;%</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Linearly-related Data'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-simple-linear-regression_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="bad" class="level5">
<h5 class="anchored" data-anchor-id="bad">Bad:</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>nonlinear_data <span class="ot">&lt;-</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    , <span class="at">y =</span> <span class="dv">30</span> <span class="sc">+</span> <span class="dv">10</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>nonlinear_data <span class="sc">%&gt;%</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Quadratically-related Data'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-simple-linear-regression_files/figure-html/bad-example-linear-relationship-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="independence-of-errors" class="level4">
<h4 class="anchored" data-anchor-id="independence-of-errors">Independence of Errors</h4>
<section id="good-1" class="level5">
<h5 class="anchored" data-anchor-id="good-1">Good:</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>independent_errors_data <span class="ot">&lt;-</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">45</span>, <span class="at">sd =</span> <span class="dv">4</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    , <span class="at">y =</span> <span class="dv">5</span> <span class="sc">-</span><span class="dv">10</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">6</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    , <span class="at">prediction =</span> <span class="dv">5</span> <span class="sc">-</span> <span class="dv">10</span><span class="sc">*</span>x</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    , <span class="at">error =</span> y <span class="sc">-</span> prediction</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>independent_errors_data <span class="sc">%&gt;%</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> error)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> error, <span class="at">ymax =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Residuals vs x-values"</span>, <span class="st">"With error distance lines"</span>) <span class="sc">+</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-simple-linear-regression_files/figure-html/good-example-independent-errors-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="bad-1" class="level5">
<h5 class="anchored" data-anchor-id="bad-1">Bad:</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>dependent_errors_data <span class="ot">&lt;-</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="dv">4</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    , <span class="at">y =</span> <span class="dv">5</span> <span class="sc">-</span> <span class="dv">10</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, x, .<span class="dv">5</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    , <span class="at">prediction =</span> <span class="dv">5</span> <span class="sc">-</span> <span class="dv">10</span><span class="sc">*</span>x</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    , <span class="at">error =</span> y <span class="sc">-</span> prediction</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>dependent_errors_data <span class="sc">%&gt;%</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> error)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> error, <span class="at">ymax =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Residuals vs x-values"</span>, <span class="st">"With error distance lines"</span>) <span class="sc">+</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-simple-linear-regression_files/figure-html/bad-example-independent-errors-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="normality-of-errors" class="level4">
<h4 class="anchored" data-anchor-id="normality-of-errors">Normality of Errors</h4>
<section id="good-2" class="level5">
<h5 class="anchored" data-anchor-id="good-2">Good:</h5>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>normal_errors_data <span class="ot">&lt;-</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">450</span>, <span class="at">sd =</span> <span class="dv">4</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    , <span class="at">y =</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">45</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">6</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    , <span class="at">prediction =</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">45</span><span class="sc">*</span>x</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    , <span class="at">error =</span> y <span class="sc">-</span> prediction</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>normal_errors_data <span class="sc">%&gt;%</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> error)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> error, <span class="at">ymax =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Residuals vs x-values"</span>, <span class="st">"With error distance lines"</span>) <span class="sc">+</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>normal_errors_data <span class="sc">%&gt;%</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> error)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">40</span>, <span class="at">fill =</span> <span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of Errors"</span>) <span class="sc">+</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="01-simple-linear-regression_files/figure-html/good-example-normal-errors-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="01-simple-linear-regression_files/figure-html/good-example-normal-errors-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<hr>
</section>
<section id="bad-2" class="level5">
<h5 class="anchored" data-anchor-id="bad-2">Bad:</h5>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>nonnormal_errors_data <span class="ot">&lt;-</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">450</span>, <span class="at">sd =</span> <span class="dv">4</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    , <span class="at">y =</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">45</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">max =</span> <span class="dv">2</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    , <span class="at">prediction =</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">45</span><span class="sc">*</span>x</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    , <span class="at">error =</span> y <span class="sc">-</span> prediction</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>nonnormal_errors_data <span class="sc">%&gt;%</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> error)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> error, <span class="at">ymax =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Residuals vs x-values"</span>, <span class="st">"With error distance lines"</span>) <span class="sc">+</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>nonnormal_errors_data <span class="sc">%&gt;%</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> error)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">40</span>, <span class="at">fill =</span> <span class="st">'red'</span>) <span class="sc">+</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of Errors"</span>) <span class="sc">+</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="01-simple-linear-regression_files/figure-html/bad-example-normal-errors-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="01-simple-linear-regression_files/figure-html/bad-example-normal-errors-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="equality-of-errors" class="level4">
<h4 class="anchored" data-anchor-id="equality-of-errors">Equality of Errors</h4>
<section id="good-3" class="level5">
<h5 class="anchored" data-anchor-id="good-3">Good:</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>equal_errors_data <span class="ot">&lt;-</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="at">mean =</span> <span class="sc">-</span><span class="dv">350</span>, <span class="at">sd =</span> <span class="dv">4</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    , <span class="at">y =</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">45</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="dv">0</span>, <span class="dv">6</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    , <span class="at">prediction =</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">45</span><span class="sc">*</span>x</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    , <span class="at">error =</span> y <span class="sc">-</span> prediction</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>equal_errors_data <span class="ot">&lt;-</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  equal_errors_data <span class="sc">%&gt;%</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">quartile =</span> <span class="fu">ntile</span>(x, <span class="at">n =</span> <span class="dv">4</span>)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>equal_errors_data <span class="sc">%&gt;%</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> error)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> error, <span class="at">ymax =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Residuals vs x-values"</span>, <span class="st">"With error distance lines"</span>) <span class="sc">+</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-simple-linear-regression_files/figure-html/good-example-equal-errors-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>equal_errors_data <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> quartile, <span class="at">y =</span> error, <span class="at">group =</span> quartile)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of Errors"</span>, <span class="st">"Homogeneous Errors"</span>) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-simple-linear-regression_files/figure-html/good-example-equal-errors-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="bad-3" class="level5">
<h5 class="anchored" data-anchor-id="bad-3">Bad:</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">9</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>nonequal_errors_data <span class="ot">&lt;-</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="at">mean =</span> <span class="sc">-</span><span class="dv">350</span>, <span class="at">sd =</span> <span class="dv">4</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    , <span class="at">y =</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">45</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, (x <span class="sc">+</span> <span class="dv">350</span>)<span class="sc">^</span><span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    , <span class="at">prediction =</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">45</span><span class="sc">*</span>x</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    , <span class="at">error =</span> y <span class="sc">-</span> prediction</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>nonequal_errors_data <span class="ot">&lt;-</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  nonequal_errors_data <span class="sc">%&gt;%</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">quartile =</span> <span class="fu">ntile</span>(x, <span class="at">n =</span> <span class="dv">4</span>)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>nonequal_errors_data <span class="sc">%&gt;%</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> quartile, <span class="at">y =</span> error, <span class="at">group =</span> quartile)</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of Errors"</span>, <span class="st">"Heterogenous Errors"</span>) <span class="sc">+</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01-simple-linear-regression_files/figure-html/bad-example-equal-errors-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="r-diagnostic-plots" class="level3">
<h3 class="anchored" data-anchor-id="r-diagnostic-plots">R Diagnostic Plots</h3>
<section id="model-assumptions-not-violated" class="level4">
<h4 class="anchored" data-anchor-id="model-assumptions-not-violated">Model assumptions not violated</h4>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm_height_weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2" data-layout-nrow="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="01-simple-linear-regression_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="01-simple-linear-regression_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="01-simple-linear-regression_files/figure-html/unnamed-chunk-20-3.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="01-simple-linear-regression_files/figure-html/unnamed-chunk-20-4.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<hr>
</section>
<section id="model-assumptions-violated" class="level4">
<h4 class="anchored" data-anchor-id="model-assumptions-violated">Model assumptions violated</h4>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>nonequal_errors_lm <span class="ot">&lt;-</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> nonequal_errors_data)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nonequal_errors_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-layout-ncol="2" data-layout-nrow="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="01-simple-linear-regression_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="01-simple-linear-regression_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="01-simple-linear-regression_files/figure-html/unnamed-chunk-21-3.png" class="img-fluid" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="01-simple-linear-regression_files/figure-html/unnamed-chunk-21-4.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</section>
</section>
<section id="future-regression-topics" class="level3">
<h3 class="anchored" data-anchor-id="future-regression-topics">Future Regression Topics</h3>
<div class="incremental">
<ul class="incremental">
<li>No-intercept model</li>
<li>Polynomial regression</li>
<li>Multiple regression</li>
<li>Logistic regression</li>
<li>Analysis of Variance (ANOVA)</li>
<li>Multivariate regression</li>
</ul>
</div>
</section>
</section>
<section id="head-1" class="level1">
<h1>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</h1>
<blockquote class="blockquote">
<blockquote class="blockquote">
<blockquote class="blockquote">
<blockquote class="blockquote">
<blockquote class="blockquote">
<blockquote class="blockquote">
<blockquote class="blockquote">
<p>946b5fb0f27eca67d94b53276b2925a05848ea49</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>